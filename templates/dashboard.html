<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <link rel="manifest" href="/manifest.json">
    <title>Danso Terminal - Unified Command</title> 

    <link rel="shortcut icon" href="{{ url_for('static', filename='images/favicon.ico') }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='images/apple-touch-icon.png') }}">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    
    <canvas id="heroCanvas"></canvas>

    <header class="ios-header sts-header">
        <div class="brand-logo">
            <img src="{{ url_for('static', filename='images/danso_logo.png') }}" alt="Logo">
            <span>TERMINAL</span>
        </div>
        
        <div class="system-status">
            <div class="status-item"><span class="dot blink"></span> LIVE</div>
            <div class="status-item mobile-hide"><i class="fas fa-database"></i> DB</div>
            <div class="status-item" id="clock">00:00:00</div>
        </div>

        <div class="user-actions">
            <button id="subscribe-btn" class="notification-button"><i class="fas fa-bell"></i></button>
            <a href="/logout" class="nav-button secondary">Log out</a>
        </div>
    </header>

    <main class="content-wrapper">

        <div class="ios-ticker-tape">
            <div class="scrolling-bar-container glass-card">
                <div class="scrolling-bar-track" id="scrolling-bar-track">
                    </div>
            </div>
        </div>

        <div class="ios-layout-grid">

            <section class="ios-scanner-section ios-card signal-feed">
                <div class="ios-card-header card-header">
                    <h3><i class="fas fa-satellite-dish"></i> Realtime Scanner</h3>
                    <div class="live-indicator"><span class="dot blink"></span> ACTIVE</div>
                </div>
                
                <div id="signal-feed-container" class="feed-scroll ios-scanner-feed">
                    <div class="empty-state">Initializing Signal Stream...</div>
                </div>
            </section>

            <section class="ios-sniper-section ios-card">
                <div class="ios-card-header card-header">
                    <h3><i class="fas fa-crosshairs"></i> Sniper Targets</h3>
                    <span class="text-dim">MODEL: XGBOOST_V5.3</span>
                </div>
                
                <div class="table-wrapper">
                    <table class="sts-table">
                        <thead>
                            <tr>
                                <th>TICKER</th>
                                <th>PRICE</th>
                                <th>SCORE</th>
                                <th>OBI</th>
                                <th>RISK</th>
                                <th>STATUS</th>
                            </tr>
                        </thead>
                        <tbody id="target-table-body">
                            <tr><td colspan="6" class="text-center">Loading Sniper Engine...</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section class="ios-risk-section">
                
                <div class="ios-card">
                    <div class="ios-card-header card-header">
                        <h3><i class="fas fa-shield-alt"></i> Active Focus</h3>
                    </div>
                    
                    <div class="risk-hero" style="text-align: center; padding: 20px 0;">
                        <div class="value highlight" id="risk-prob" style="font-size: 3.5rem; font-weight: 800; color: #0A84FF; line-height: 1;">0%</div>
                        <div class="label" style="font-size: 0.8rem; color: #8E8E93; text-transform: uppercase; letter-spacing: 1px; margin-top: 5px;">AI Confidence</div>
                    </div>

                    <div class="risk-grid compact" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px; margin-top: 10px;">
                        <div class="risk-item mini" style="text-align: center;">
                            <span class="label" style="font-size: 0.7rem; display: block; color: #8E8E93;">ENTRY</span>
                            <span class="value" id="risk-entry" style="font-size: 0.9rem; font-weight: 600;">-</span>
                        </div>
                        <div class="risk-item mini" style="text-align: center;">
                            <span class="label" style="font-size: 0.7rem; display: block; color: #8E8E93;">TARGET</span>
                            <span class="value text-green" id="risk-target" style="font-size: 0.9rem; font-weight: 600;">-</span>
                        </div>
                        <div class="risk-item mini" style="text-align: center;">
                            <span class="label" style="font-size: 0.7rem; display: block; color: #8E8E93;">STOP</span>
                            <span class="value text-warn" id="risk-stop" style="font-size: 0.9rem; font-weight: 600;">-</span>
                        </div>
                    </div>
                </div>

                <div class="ios-card">
                    <div class="ios-card-header card-header">
                        <h3><i class="fas fa-chart-pie"></i> Performance</h3>
                    </div>
                    <div class="stat-flex">
                        <div class="stat-box">
                            <span class="label">WIN RATE</span>
                            <div class="val text-green" id="session-winrate">RUNNING</div>
                        </div>
                        <div class="stat-box">
                            <span class="label">SIGNALS</span>
                            <div class="val" id="session-signals">0</div>
                        </div>
                    </div>
                    <div class="heatmap-container">
                        <div class="heatmap-grid">
                            <div class="heat-block hot">TECH</div>
                            <div class="heat-block warm">BIO</div>
                            <div class="heat-block cool">EV</div>
                            <div class="heat-block cool">CRYPTO</div>
                        </div>
                    </div>
                </div>

            </section>

            <section class="ios-watching-section">
                
                <div class="ios-card">
                    <div class="ios-card-header card-header">
                        <h3><i class="fas fa-eye"></i> Scanner Watching</h3>
                        <div>
                            <span id="scan-watching-count">0</span>
                            <span id="scan-status-text">Idle</span>
                        </div>
                    </div>
                    <div id="ticker-list-container" class="ticker-list"></div>
                </div>

                <div class="ios-card">
                    <div class="ios-card-header card-header">
                        <h3><i class="fas fa-lock"></i> Sniper Lock</h3>
                    </div>
                    <div id="micro-panel">
                        <div class="empty-state">Waiting for target lock...</div>
                    </div>
                </div>

            </section>

            <section class="ios-utils-section">
                
                <div class="ios-card community-section">
                    <div class="ios-card-header card-header">
                        <h3><i class="fas fa-comments"></i> Chat</h3>
                    </div>
                    <div class="post-feed" id="community-feed-container">
                         <div class="empty-state">Loading Posts...</div> 
                    </div>
                    <form id="post-form" onsubmit="return false;">
                        <input type="text" name="author" placeholder="Name" required> 
                        <div class="input-row">
                            <textarea name="content" placeholder="Share insight..." rows="1" required></textarea> 
                            <button type="button" id="post-submit-btn">Post</button> 
                        </div>
                    </form>
                </div>

                <div class="ios-card settings-card">
                    <div class="ios-card-header card-header">
                        <h3><i class="fas fa-sliders-h"></i> Alerts</h3>
                    </div>
                    <div class="settings-body">
                        <div class="control-group">
                            <input type="number" id="min-score-input" placeholder="0" min="0" max="99" value="0">
                            <span class="unit">Score</span>
                            <button id="save-score-btn" class="btn-primary">Update</button>
                        </div>
                    </div>
                </div>

            </section>

        </div> </main>

    <div id="ticker-modal" class="modal-overlay">
        <div class="modal-content ios-card">
            <div class="modal-header ios-card-header">
                <h2 id="modal-ticker-name">Loading...</h2>
                <span class="close-button" id="modal-close-btn">&times;</span>
            </div>
            <div class="modal-tabs">
                 <button class="tab-button active" onclick="showModalTab('info', this)">Info</button> 
                <button class="tab-button" onclick="showModalTab('quote', this)">Quote</button> 
                <button class="tab-button" onclick="showModalTab('financials', this)">Financials</button> 
                <button class="tab-button" onclick="showModalTab('chart', this)">Chart</button> 
            </div>
            <div class="modal-body">
                 <div id="tab-info" class="tab-content active"><p>Loading info...</p></div> 
                <div id="tab-quote" class="tab-content"><p>Loading quote...</p></div> 
                <div id="tab-financials" class="tab-content"><p>Loading financials...</p></div> 
                <div id="tab-chart" class="tab-content">
                    <div id="chart-container"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/landing-animation.js') }}"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}" type="module" defer></script>
    <script src="{{ url_for('static', filename='js/sts.js') }}" defer></script>

</body>
</html>